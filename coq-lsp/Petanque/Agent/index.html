<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Agent (coq-lsp.Petanque.Agent)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../../index.html">coq-lsp</a> &#x00BB; <a href="../index.html">Petanque</a> &#x00BB; Agent</nav><header class="odoc-preamble"><h1>Module <code><span>Petanque.Agent</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec module anchored" id="module-State"><a href="#module-State" class="anchor"></a><code><span><span class="keyword">module</span> <a href="State/index.html">State</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Petanque.Agent</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Error"><a href="#module-Error" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Error/index.html">Error</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Petanque errors</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-R"><a href="#module-R" class="anchor"></a><code><span><span class="keyword">module</span> <a href="R/index.html">R</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Petanque results</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Run_opts"><a href="#module-Run_opts" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Run_opts/index.html">Run_opts</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Run_result"><a href="#module-Run_result" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Run_result/index.html">Run_result</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><p>Protocol notes:</p><p>The idea is that the types of the functions here have a direct translation to the JSON-RPC (or any other) protocol.</p><p>Thus, types here correspond to types in the wire, except for cases where the protocol layer performs an implicit mapping on types.</p><p>So far, the mappings are:</p><ul><li><code>uri</code> &lt;-&gt; <code>Doc.t</code></li><li><code>int</code> &lt;-&gt; <code>State.t</code></li></ul><p>The <code>State.t</code> mapping is easy to do at the protocol level with a simple mapping, however <code>uri -&gt; Doc.t</code> may need to yield to the document manager to build the corresponding <code>doc</code>. This is very convenient for users, but introduces a little bit more machinery.</p><p>We could imagine a future where <code>State.t</code> need to be managed asynchronously, then the same approach that we use for <code>Doc.t</code> could happen.</p><div class="odoc-spec"><div class="spec value anchored" id="val-get_root_state"><a href="#val-get_root_state" class="anchor"></a><code><span><span class="keyword">val</span> get_root_state : 
  <span><span class="optlabel">?opts</span>:<a href="Run_opts/index.html#type-t">Run_opts.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">doc</span>:<a href="../../Fleche/Doc/index.html#type-t">Fleche.Doc.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="State/index.html#type-t">State.t</a> <a href="Run_result/index.html#type-t">Run_result.t</a></span> <a href="R/index.html#type-t">R.t</a></span></span></code></div><div class="spec-doc"><p><code>get_root_state ?opts ~doc</code> return the root state of the document <code>doc</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_state_at_pos"><a href="#val-get_state_at_pos" class="anchor"></a><code><span><span class="keyword">val</span> get_state_at_pos : 
  <span><span class="optlabel">?opts</span>:<a href="Run_opts/index.html#type-t">Run_opts.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">doc</span>:<a href="../../Fleche/Doc/index.html#type-t">Fleche.Doc.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">point</span>:<span>(int * int)</span> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="State/index.html#type-t">State.t</a> <a href="Run_result/index.html#type-t">Run_result.t</a></span> <a href="R/index.html#type-t">R.t</a></span></span></code></div><div class="spec-doc"><p><code>get_state_at_pos ?opts ~doc ~position</code> return the state at position <code>position</code> in <code>doc</code>. Note that LSP positions are zero-based!</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-start"><a href="#val-start" class="anchor"></a><code><span><span class="keyword">val</span> start : 
  <span><span class="label">token</span>:<a href="../../Coq/Limits/Token/index.html#type-t">Coq.Limits.Token.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">doc</span>:<a href="../../Fleche/Doc/index.html#type-t">Fleche.Doc.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?opts</span>:<a href="Run_opts/index.html#type-t">Run_opts.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?pre_commands</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">thm</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="State/index.html#type-t">State.t</a> <a href="Run_result/index.html#type-t">Run_result.t</a></span> <a href="R/index.html#type-t">R.t</a></span></span></code></div><div class="spec-doc"><p><code>start ~token ~doc ~pre_commands ~thm</code> start a new proof for theorem <code>thm</code> in file <code>uri</code> under <code>fn</code>. <code>token</code> can be used to interrupt the computation. Returns the proof state or error otherwise. <code>pre_commands</code> is a string of dot-separated Coq commands that will be executed before the proof starts.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-run"><a href="#val-run" class="anchor"></a><code><span><span class="keyword">val</span> run : 
  <span><span class="label">token</span>:<a href="../../Coq/Limits/Token/index.html#type-t">Coq.Limits.Token.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?opts</span>:<a href="Run_opts/index.html#type-t">Run_opts.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">st</span>:<a href="State/index.html#type-t">State.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">tac</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="State/index.html#type-t">State.t</a> <a href="Run_result/index.html#type-t">Run_result.t</a></span> <a href="R/index.html#type-t">R.t</a></span></span></code></div><div class="spec-doc"><p><code>run ~token ?memo ~st ~tac</code> tries to run <code>tac</code> over state <code>st</code>. <code>memo</code> (by default true) controls whether the command execution will be memoized in Flèche incremental engine.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-goals"><a href="#val-goals" class="anchor"></a><code><span><span class="keyword">val</span> goals : 
  <span><span class="label">token</span>:<a href="../../Coq/Limits/Token/index.html#type-t">Coq.Limits.Token.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">st</span>:<a href="State/index.html#type-t">State.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><span>(string, string)</span> <a href="../../Coq/Goals/index.html#type-reified">Coq.Goals.reified</a></span> option</span> <a href="R/index.html#type-t">R.t</a></span></span></code></div><div class="spec-doc"><p><code>goals ~token ~st</code> return the list of goals for a given <code>st</code></p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Premise"><a href="#module-Premise" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Premise/index.html">Premise</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-premises"><a href="#val-premises" class="anchor"></a><code><span><span class="keyword">val</span> premises : <span><span class="label">token</span>:<a href="../../Coq/Limits/Token/index.html#type-t">Coq.Limits.Token.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">st</span>:<a href="State/index.html#type-t">State.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="Premise/index.html#type-t">Premise.t</a> list</span> <a href="R/index.html#type-t">R.t</a></span></span></code></div><div class="spec-doc"><p>Return the list of defined constants and inductives for a given state. For now we just return their fully qualified name, but more options are of course possible.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-ast"><a href="#val-ast" class="anchor"></a><code><span><span class="keyword">val</span> ast : 
  <span><span class="label">token</span>:<a href="../../Coq/Limits/Token/index.html#type-t">Coq.Limits.Token.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">st</span>:<a href="State/index.html#type-t">State.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">text</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><a href="../../Coq/Ast/index.html#type-t">Coq.Ast.t</a> option</span> <a href="Run_result/index.html#type-t">Run_result.t</a></span> <a href="R/index.html#type-t">R.t</a></span></span></code></div><div class="spec-doc"><p>Return the ast of a string <code>text</code>, parsed at state <code>st</code> . Returns <code>None</code> on EOF</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-ast_at_pos"><a href="#val-ast_at_pos" class="anchor"></a><code><span><span class="keyword">val</span> ast_at_pos : 
  <span><span class="label">doc</span>:<a href="../../Fleche/Doc/index.html#type-t">Fleche.Doc.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">point</span>:<span>(int * int)</span> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../../Coq/Ast/index.html#type-t">Coq.Ast.t</a> option</span> <a href="R/index.html#type-t">R.t</a></span></span></code></div><div class="spec-doc"><p>Return the ast of a position in the document <code>doc</code> at position <code>point</code>. Will error if there is no node, will return <code>None</code>, when there is a node at the position, but the ast is not available, for example due to parsing error</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-version"><a href="#val-version" class="anchor"></a><code><span><span class="keyword">val</span> version : int</span></code></div><div class="spec-doc"><p>Petanque version</p></div></div></div></body></html>
