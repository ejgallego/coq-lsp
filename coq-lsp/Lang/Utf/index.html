<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Utf (coq-lsp.Lang.Utf)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../../index.html">coq-lsp</a> &#x00BB; <a href="../index.html">Lang</a> &#x00BB; Utf</nav><header class="odoc-preamble"><h1>Module <code><span>Lang.Utf</span></code></h1><p>This module provides facilities for translating language-based locations to protocol-based locations.</p><p>After a long discussion (thanks Léo !), we have decided that the best is to have `Lang.Point` to store columns offset in the values that are native to the protocol under consideration, set by the upper layers.</p><p>This scheme kind of follows what we have done since the start with coq-lsp.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec module anchored" id="module-Encoding"><a href="#module-Encoding" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Encoding/index.html">Encoding</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><p>Future work: support setting protocol enconding</p><p>Unicode terminology refresher:</p><ul><li>character, code point: The real unicode character</li><li>byte or 16bit offset / code unit: The encoded version</li></ul><div class="odoc-spec"><div class="spec type anchored" id="type-utf8_string"><a href="#type-utf8_string" class="anchor"></a><code><span><span class="keyword">type</span> utf8_string</span><span> = string</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-char"><a href="#type-char" class="anchor"></a><code><span><span class="keyword">type</span> char</span><span> = int</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-utf8_index"><a href="#type-utf8_index" class="anchor"></a><code><span><span class="keyword">type</span> utf8_index</span><span> = int</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-utf16_index"><a href="#type-utf16_index" class="anchor"></a><code><span><span class="keyword">type</span> utf16_index</span><span> = int</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-utf16_offset_of_utf8_offset"><a href="#val-utf16_offset_of_utf8_offset" class="anchor"></a><code><span><span class="keyword">val</span> utf16_offset_of_utf8_offset : 
  <span><span class="label">line</span>:<a href="#type-utf8_string">utf8_string</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">offset</span>:<a href="#type-utf8_index">utf8_index</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-utf16_index">utf16_index</a></span></code></div><div class="spec-doc"><p>UTF-16 offset from UTF-8 offset; line is enconded in UTF-8</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-utf8_offset_of_utf16_offset"><a href="#val-utf8_offset_of_utf16_offset" class="anchor"></a><code><span><span class="keyword">val</span> utf8_offset_of_utf16_offset : 
  <span><span class="label">line</span>:<a href="#type-utf8_string">utf8_string</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">offset</span>:<a href="#type-utf16_index">utf16_index</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-utf8_index">utf8_index</a></span></code></div><div class="spec-doc"><p>Get the byte position of a code point indexed in UTF-16 code units in a UTF-8 encoded utf8_string. Returns the position of the last character if the UTF-16 position was out of bounds.</p></div></div><p>To UTF-16 offsets</p><div class="odoc-spec"><div class="spec value anchored" id="val-length_utf16"><a href="#val-length_utf16" class="anchor"></a><code><span><span class="keyword">val</span> length_utf16 : <span><a href="#type-utf8_string">utf8_string</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-utf16_index">utf16_index</a></span></code></div><div class="spec-doc"><p>Length in UTF-16 code points</p></div></div><p>Not used anywhere, remove?</p><p>Number of characters in the utf-8-encoded utf8_string.</p><p>Converstion from char to UTF-8/16</p><div class="odoc-spec"><div class="spec value anchored" id="val-utf8_offset_of_char"><a href="#val-utf8_offset_of_char" class="anchor"></a><code><span><span class="keyword">val</span> utf8_offset_of_char : <span><span class="label">line</span>:<a href="#type-utf8_string">utf8_string</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">char</span>:<a href="#type-char">char</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-utf8_index">utf8_index</a> option</span></span></code></div><div class="spec-doc"><p>UTF-8 Char to byte index position; line is enconded in UTF-8</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-utf16_offset_of_char"><a href="#val-utf16_offset_of_char" class="anchor"></a><code><span><span class="keyword">val</span> utf16_offset_of_char : <span><span class="label">line</span>:<a href="#type-utf8_string">utf8_string</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">char</span>:int <span class="arrow">&#45;&gt;</span></span> <a href="#type-utf16_index">utf16_index</a></span></code></div><div class="spec-doc"><p>Get the utf16 position of a code point indexed in unicode code points in a UTF-8 encoded utf8_string. The position must be in bounds.</p></div></div><p>Converstion to char from UTF-8/16</p><div class="odoc-spec"><div class="spec value anchored" id="val-char_of_utf8_offset"><a href="#val-char_of_utf8_offset" class="anchor"></a><code><span><span class="keyword">val</span> char_of_utf8_offset : <span><span class="label">line</span>:<a href="#type-utf8_string">utf8_string</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">offset</span>:<a href="#type-utf8_index">utf8_index</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-char">char</a> option</span></span></code></div><div class="spec-doc"><p>Byte index to character position <code>also called a codepoint</code>, line is encoded in UTF-8</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-char_of_utf16_offset"><a href="#val-char_of_utf16_offset" class="anchor"></a><code><span><span class="keyword">val</span> char_of_utf16_offset : <span><span class="label">line</span>:<a href="#type-utf8_string">utf8_string</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">offset</span>:<a href="#type-utf16_index">utf16_index</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-char">char</a></span></code></div><div class="spec-doc"><p>Get the unicode position of a code point indexed in UTF-16 code units in a utf-8 encoded utf8_string. Returns the position of the last character if the utf-16 position was out of bounds.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-next"><a href="#val-next" class="anchor"></a><code><span><span class="keyword">val</span> next : <span>string <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p>For testing</p></div></div></div></body></html>
